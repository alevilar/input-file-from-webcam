import{r as t,c as i,h as s,H as e}from"./p-5e58f578.js";class n{constructor(){}initCamera(t,i,s={exact:"user"},e=null){this.resetCamera();this.elVideo=t;this.canvas=i;this.elVideo.parentNode.insertBefore(this.canvas,this.elVideo.nextSibling);if(navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia({audio:false,video:{width:{min:200},height:{min:200},facingMode:s}}).then((t=>{this.stream=t;this.elVideo.srcObject=this.stream;this.renderToCanvas(e)})).catch((function(t){console.log("Something went wrong!",t)}))}}renderToCanvas(t=null){let i=this.canvas.getContext("2d");let s=this.elVideo.videoWidth;let e=this.elVideo.videoHeight;var n=Math.min(s,e);var a=(s-n)/2;var h=(e-n)/2;if(typeof t=="function"){t.call(i,this.elVideo,a,h,n,n,0,0,this.canvas.width,this.canvas.height)}else{i.drawImage(this.elVideo,a,h,n,n,0,0,this.canvas.width,this.canvas.height)}requestAnimationFrame((()=>this.renderToCanvas()))}resetCamera(){var t,i;if(this.stream)(i=(t=this.stream)===null||t===void 0?void 0:t.getVideoTracks())===null||i===void 0?void 0:i.forEach((t=>{var i;t===null||t===void 0?void 0:t.stop();(i=this.stream)===null||i===void 0?void 0:i.removeTrack(t)}));if(this.elVideo)this.elVideo.srcObject=null}async takePic(){return new Promise(((t,i)=>{try{this.canvas.toBlob((i=>{const s="pic_"+Math.abs(Math.round(Math.random()*1e3));var e=new File([i],s,{type:"image/jpeg"});t(e)}),"image/jpeg",.8)}catch(t){i(t)}}))}}const a=new n;const h=":host{display:inline-block;width:100px;filter:drop-shadow(2px 4px 6px black);border:#5a5252 1px solid;border-style:groove}video{display:none}canvas{width:100%;height:100%}";const o=class{constructor(s){t(this,s);this.pictureTaken=i(this,"pictureTaken",6);this.facingModeChanged=i(this,"facingModeChanged",6);this.width=460;this.height=460;this.facingMode="user";this.drawImageCb=null}async takePic(){const t=await a.takePic();this.pictureTaken.emit(t);return t}async toggleCamera(){this.__toogleFacingMode()}onClickHandler(){this.__toogleFacingMode()}__toogleFacingMode(){this.facingMode=this.facingMode!="user"?"user":"environment";this.facingModeChanged.emit(this.facingMode)}__createfacingModeConstrainDOMString(){return{ideal:this.facingMode}}componentWillMount(){}async componentDidRender(){a.initCamera(this.elVideo,this.elCanvas,this.__createfacingModeConstrainDOMString(),this.drawImageCb)}async disconnectedCallback(){a.resetCamera()}render(){return s(e,null,s("slot",{name:"before"}),s("video",{autoplay:"true",ref:t=>this.elVideo=t}),s("canvas",{ref:t=>this.elCanvas=t,width:this.width,height:this.height}),s("slot",null),s("slot",{name:"after"}))}};o.style=h;export{o as input_file_from_webcam};
//# sourceMappingURL=p-9d29d4da.entry.js.map