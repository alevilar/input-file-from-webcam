import{r as t,c as i,h as s,H as e}from"./p-d57d6a67.js";class n{constructor(){}initCamera(t,i,s={exact:"user"},e=null){this.resetCamera();this.elVideo=t;this.canvas=i;this.elVideo.parentNode.insertBefore(this.canvas,this.elVideo.nextSibling);if(navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia({audio:false,video:{width:{min:200},height:{min:200},facingMode:s}}).then((t=>{this.stream=t;this.elVideo.srcObject=this.stream;this.renderToCanvas(e)})).catch((function(t){console.log("Something went wrong!",t)}))}}renderToCanvas(t=null){let i=this.canvas.getContext("2d");let s=this.elVideo.videoWidth;let e=this.elVideo.videoHeight;var n=Math.min(s,e);var h=(s-n)/2;var a=(e-n)/2;if(typeof t=="function"){t.call(i,this.elVideo,h,a,n,n,0,0,this.canvas.width,this.canvas.height)}else{i.drawImage(this.elVideo,h,a,n,n,0,0,this.canvas.width,this.canvas.height)}requestAnimationFrame((()=>this.renderToCanvas()))}resetCamera(){var t,i;if(this.stream)(i=(t=this.stream)===null||t===void 0?void 0:t.getVideoTracks())===null||i===void 0?void 0:i.forEach((t=>{var i;t===null||t===void 0?void 0:t.stop();(i=this.stream)===null||i===void 0?void 0:i.removeTrack(t)}));if(this.elVideo)this.elVideo.srcObject=null}async takePic(){return new Promise(((t,i)=>{try{this.canvas.toBlob((i=>{const s="pic_"+Math.abs(Math.round(Math.random()*1e3));var e=new File([i],s);t(e)}))}catch(t){i(t)}}))}}const h=new n;const a=":host{display:inline-block;width:100px;filter:drop-shadow(2px 4px 6px black);border:#5a5252 1px solid;border-style:groove}video{display:none}canvas{width:100%;height:100%}";const o=class{constructor(s){t(this,s);this.pictureTaken=i(this,"pictureTaken",6);this.facingModeChanged=i(this,"facingModeChanged",6);this.width=460;this.height=460;this.facingMode=null;this.drawImageCb=null;this.__facingMode="user"}async takePic(){const t=await h.takePic();this.pictureTaken.emit(t);return t}onClickHandler(){this.__toogleFacingMode()}__toogleFacingMode(){if(this.facingMode==null){this.__facingMode=this.__facingMode=="environment"?"user":"environment";this.facingModeChanged.emit(this.__createfacingModeConstrainDOMString())}}__createfacingModeConstrainDOMString(){return{ideal:this.__facingMode}}componentWillMount(){if(this.facingMode){this.__facingMode=this.facingMode}}async componentDidRender(){h.initCamera(this.elVideo,this.elCanvas,this.__createfacingModeConstrainDOMString(),this.drawImageCb)}async disconnectedCallback(){h.resetCamera()}render(){return s(e,null,s("slot",{name:"before"}),s("video",{autoplay:"true",ref:t=>this.elVideo=t}),s("canvas",{ref:t=>this.elCanvas=t,width:this.width,height:this.height}),s("slot",null),s("slot",{name:"after"}))}};o.style=a;export{o as input_file_from_webcam};
//# sourceMappingURL=p-c3c4e36a.entry.js.map